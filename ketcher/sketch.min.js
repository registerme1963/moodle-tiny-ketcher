$(document).ready((function(){var e=document.getElementById("tinymce_ketcher-iframe");window.ketcher=null;var t=setInterval((function(){var n=e.contentWindow.ketcher;n&&(clearInterval(t),window.ketcher=n,$("#actionButton").click((function(){!async function(e){var t=await e.getKet(),n=await e.generateImage(t,{outputFormat:"svg",backgroundColor:"255, 255, 255"}),i=new FileReader;i.addEventListener("load",(function(){var e=i.result,a=(new DOMParser).parseFromString(atob(e.split(",")[1]),"image/svg+xml").documentElement,r=a.getAttribute("width"),o=a.getAttribute("height");if(window.parent.tinyMCE&&window.parent.tinyMCE.activeEditor){var c=URL.createObjectURL(n),d=JSON.stringify(t).replace(/\\n/g,"").replace(/\\"/g,'"').replace(/ /g,"").slice(1,-1),l='<img src="'+c+'" width="'+r+'" height="'+o+'">';window.parent.tinyMCE.activeEditor.execCommand("mceInsertContent",0,l),window.parent.tinyMCE.activeEditor.execCommand("mceInsertContent",0,"\x3c!--"+d+"--\x3e")}else console.log("TinyMCE not initialized");$(window.parent.document).find(".modal").find(".close").click()})),i.readAsDataURL(n)}(n)})))}),500)}));
