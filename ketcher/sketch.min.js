$(document).ready((function(){var t=!0;function e(t){return new Promise(((e,n)=>{const a=new FileReader;a.onloadend=()=>e(a.result),a.onerror=n,a.readAsDataURL(t)}))}function n(){var t=$("#output"),n=$("#width").val(),a=$("#height").val();ketcher.getKet().then((t=>ketcher.generateImage(t,{outputFormat:"svg",backgroundColor:"255, 255, 255"}))).then((t=>e(t))).then((e=>{var i=$("<img>").attr("src",e).attr("width",n).attr("height",a);t.html("").append(i)})).catch((t=>window.alert(t)))}function a(){return new Promise(((t,n)=>{ketcher.getKet().then((a=>{ketcher.generateImage(a,{outputFormat:"svg",backgroundColor:"255, 255, 255"}).then((t=>e(t))).then((e=>{t({dataURI:e,ketData:a})})).catch(n)})).catch(n)}))}$("#width, #height").on("input",n),$("#actionButton").click((async function(){var e,i;t?($(this).attr("data-state","preview"),await n(),$(this).html("Confirm & Close").attr("data-state","confirm"),t=!1):(e=$("#width"),i=$("#height"),a().then((({dataURI:t,ketData:n})=>{if(window.parent.tinyMCE&&window.parent.tinyMCE.activeEditor){var a='<img src="'+t+'" width="'+e.val()+'px" height="'+i.val()+'px">';window.parent.tinyMCE.activeEditor.execCommand("mceInsertContent",0,a),window.parent.tinyMCE.activeEditor.execCommand("mceInsertContent",0,"\x3c!--"+n+"--\x3e")}else console.log("TinyMCE not initialized");$(window.parent.document).find(".modal").find(".close").click()})).catch((t=>{console.error("ERROR IN GETDATA",t),alert(t)})))})),window.getData=a}));