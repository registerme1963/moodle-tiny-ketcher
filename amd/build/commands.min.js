define("tiny_ketcher/commands",["exports","editor_tiny/utils","core/str","./common","./embed"],(function(_exports,_utils,_str,_common,_embed){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getSetup=void 0;
/**
   * Common values helper for the Moodle tiny_ketcher plugin.
   *
   * @module      tiny_ketcher/commands
   * @copyright   2024 Venkatesan Rangarajan <venkatesanrpu@gmail.com>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const handleAction=editor=>{new _embed.KetcherEmbed(editor).init()};_exports.getSetup=async()=>{const isImage=node=>"img"===node.nodeName.toLowerCase(),[ketcherButtonNameTitle,buttonImage]=await Promise.all([(0,_str.get_string)("ketcherButtonNameTitle",_common.component),(0,_utils.getButtonImage)("icon",_common.component)]);return editor=>{editor.ui.registry.addIcon(_common.icon,buttonImage.html),editor.ui.registry.addButton(_common.ketcherButtonName,{icon:_common.icon,tooltip:ketcherButtonNameTitle,onAction:()=>handleAction(editor)}),editor.ui.registry.addToggleButton(_common.ketcherButtonName,{icon:_common.icon,tooltip:ketcherButtonNameTitle,onAction:()=>handleAction(editor,window.json),onSetup:api=>editor.selection.selectorChangedWithUnbind("img:not([data-mce-object]):not([data-mce-placeholder]),figure.image",(function(){var parentNode=editor.selection.getNode().parentNode;const commentMatch=editor.serializer.serialize(parentNode).match(/<!--(.*?)-->/);if(commentMatch)try{var json=JSON.parse(commentMatch[1]);api.setActive(!0),window.json=JSON.stringify(json)}catch(e){api.setActive(!1)}else api.setActive(!1)})).unbind}),editor.ui.registry.addContextToolbar(_common.ketcherButtonName,{predicate:isImage,items:_common.ketcherButtonName,position:"node",scope:"node"}),editor.ui.registry.addMenuItem(_common.ketcherButtonName,{icon:_common.icon,text:ketcherButtonNameTitle,onAction:()=>handleAction(editor)})}}}));

//# sourceMappingURL=commands.min.js.map