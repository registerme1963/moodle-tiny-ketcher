define("tiny_ketcher/commands",["exports","editor_tiny/utils","core/str","./common","./embed"],(function(_exports,_utils,_str,_common,_embed){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getSetup=void 0;
/**
   * Common values helper for the Moodle tiny_ketcher plugin.
   *
   * @module      tiny_ketcher/commands
   * @copyright   2024 Venkatesan Rangarajan <venkatesanrpu@gmail.com>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const handleAction=editor=>{new _embed.KetcherEmbed(editor).init()};_exports.getSetup=async()=>{const[ketcherButtonNameTitle,ketcherMenuNameTitle,buttonImage]=await Promise.all([(0,_str.get_string)("ketcherButtonNameTitle",_common.component),(0,_str.get_string)("ketcherMenuNameTitle",_common.component),(0,_utils.getButtonImage)("icon",_common.component)]);return editor=>{editor.ui.registry.addIcon(_common.icon,buttonImage.html),editor.ui.registry.addButton(_common.ketcherButtonName,{icon:_common.icon,tooltip:ketcherButtonNameTitle,onAction:()=>handleAction(editor)}),editor.ui.registry.addToggleButton(_common.ketcherButtonName,{icon:_common.icon,tooltip:ketcherButtonNameTitle,onAction:()=>handleAction(editor),onSetup:buttonApi=>(editor.on("NodeChange",(()=>{if("IMG"===editor.selection.getNode().nodeName){var tempData=(editor=>{let sibling=editor.selection.getNode().nextSibling;for(;sibling&&8!==sibling.nodeType;){if("BR"===sibling.nodeName){for(sibling=sibling.nextSibling;sibling&&8!==sibling.nodeType;)sibling=sibling.nextSibling;if(sibling){const data=JSON.parse(sibling.nodeValue);return sibling.parentNode.removeChild(sibling),data}}sibling=sibling.nextSibling}return sibling?JSON.parse(sibling.nodeValue):null})(editor);window.ketData=JSON.stringify(tempData),tempData?buttonApi.setActive(!0):buttonApi.setActive(!1)}else buttonApi.setActive(!1)})),()=>{editor.off("NodeChange")})}),editor.ui.registry.addMenuItem(_common.ketcherMenuName,{icon:_common.icon,text:ketcherMenuNameTitle,onAction:()=>handleAction(editor)})}}}));

//# sourceMappingURL=commands.min.js.map